<!DOCTYPE html>
<html lang="ja">







<head>
  <title>CDI 統合ガイド - Quarkus</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Security-Policy" content="
  connect-src 'self' https://dpm.demdex.net https://adobedc.demdex.net https://analytics.ossupstream.org/ https://search.quarkus.io https://smetrics.redhat.com; 
  script-src 'self' 'unsafe-inline' 'unsafe-eval'
      
      https://assets.adobedtm.com
      js.bizographics.com
      https://www.redhat.com
      https://static.redhat.com
      https://app.requestly.io/
      jsonip.com
      https://ajax.googleapis.com
      https://use.fontawesome.com
      http://www.youtube.com
      http://www.googleadservices.com
      https://googleads.g.doubleclick.net
      https://giscus.app
      https://analytics.ossupstream.org/
      https://app.mailjet.com;

  style-src 'self' https://fonts.googleapis.com https://use.fontawesome.com; 
  img-src 'self' * data:; 
  media-src 'self'; 
  frame-src https://redhat.demdex.net https://www.youtube.com https://embed.restream.io https://app.mailjet.com http://xy0p2.mjt.lu https://mj.quarkus.io https://giscus.app; 
  base-uri 'none'; 
  object-src 'none'; 
  form-action 'none'; 
  font-src 'self' https://use.fontawesome.com https://fonts.gstatic.com;" />
  <script id="adobe_dtm" src="https://www.redhat.com/dtm.js" type="text/javascript"></script>
  <script src="/assets/javascript/highlight.pack.js" type="text/javascript"></script>
  <META HTTP-EQUIV='X-XSS-Protection' CONTENT="1; mode=block">
  <META HTTP-EQUIV='X-Content-Type-Options' CONTENT="nosniff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Quarkus: Supersonic Subatomic Java">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@QuarkusIO"> 
  <meta name="twitter:creator" content="@QuarkusIO">
  <meta property="og:url" content="https://quarkus.io/guides/cdi-integration" />
  <meta property="og:title" content="CDI 統合ガイド" />
  <meta property="og:description" content="Quarkus: Supersonic Subatomic Java" />
  <meta property="og:image" content="https://quarkus.io/assets/images/quarkus_card.png" />
  
  <link rel="canonical" href="https://quarkus.io/guides/cdi-integration">
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" >
  <link rel="stylesheet" href="/guides/stylesheet/config.css" />
  <link rel="stylesheet" href="/assets/css/main.css?2021-07-29" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.5.2/css/all.css" crossorigin="anonymous">
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="Quarkus">
  <script src="/assets/javascript/hl.js" type="text/javascript"></script>
  
  
  
  
  <link rel="alternate" hreflang="x-default" href="https://quarkus.io/" />  
  <script src="/assets/javascript/tracking.js"></script>
  
  <script src="/assets/javascript/colormode.js" type="text/javascript"></script>

</head>

<body class="guides">

  


<div class="grid-wrapper communitysite">
  <div class="grid__item width-12-12">The <a href="https://quarkus.io/guides/cdi-integration">English version of quarkus.io</a> is the official project site. Translated sites are community supported on a best-effort basis.</div>
</div>


  <div class="nav-wrapper">
  <div class="grid-wrapper">
    <div class="width-12-12">
      <input type="checkbox" id="checkbox" />
      <nav id="main-nav" class="main-nav">
        <div class="logo-wrapper">
           <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_600px_reverse.png" class="project-logo" title="Quarkus"></a>
        </div>
    <label class="nav-toggle" for="checkbox"> <i class="fa fa-bars"></i>
</label>
    <ul id="menu" class="menu">
      <li class="dropdown">
        <span href="/about/">Why<i class="fas
fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/about" class="">QUARKUSとは何か?</a></li>
          <li><a href="/developer-joy" class="">開発者満足</a></li>
          <li><a href="/performance" class="">PERFORMANCE</a></li>
          <li><a href="/kubernetes-native" class="">KUBERNETES NATIVE</a></li>
          <li><a href="/standards" class="">標準</a></li>
          <li><a href="/versatility" class="">VERSATILITY</a></li>
          <li><a href="/container-first" class="">コンテナ・ファースト</a></li>

          
        </ul>
      </li>
      <li class="dropdown">
        <span href="/learn/">Learn<i class="fas
fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/get-started" class="">入門</a></li>
          <li><a href="/guides" class="active">ドキュメント</a></li>
          <li><a href="/qtips" class="">"Q" Tipsビデオ</a></li>          
          <li><a href="/books" class="">書籍</a></li>
          </ul>
      </li>
      <li class="dropdown">
        <span href="https://quarkus.io/extensions/">Extensions<i class="fas
fa-chevron-down"></i></span>
        <ul class="submenu">
          
          <!-- Note that quarkus.io is hardcoded here, because it is the only url which supports extensions -->
<li><a href="https://quarkus.io/extensions/" class="">エクステンションを探す</a></li>
          <li><a href="/faq/#what-is-a-quarkus-extension" class="">エクステンションの使用</a></li>
          <li><a href="/guides/writing-extensions" class="">エクステンションの作成</a></li>
          <li><a href="https://hub.quarkiverse.io" class="">SHARE EXTENSIONS</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="/community/">Community<i class="fas
fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/support/" class="">サポート</a></li>
          <li><a href="/blog" class="">ブログ</a></li>
          <li><a href="/discussion" class="">ディスカッション</a></li>
          <li><a href="/working-groups" class="">WORKING GROUPS</a></li>
          <li><a href="/insights" class="">ポッドキャスト</a></li>
          <li><a href="/events" class="">イベント</a></li>
          <li><a href="/newsletter" class="">ニュースレター</a></li>
          <li><a href="https://github.com/orgs/quarkusio/projects/13/views/1" class="">ロードマップ</a></li>
          </ul>
      </li>
      <li>
        <a href="https://code.quarkus.io" class="button-cta secondary
white">コーディングを開始</a>
      </li>
      <li class="dropdown">
        <span href="/language/"><div class="fas fa-globe langicon"></div><i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="https://quarkus.io/guides/cdi-integration" >OFFICIAL (ENGLISH)</a></li>
          <li><a href="https://pt.quarkus.io/guides/cdi-integration">PORTUGUÊS (BR)</a></li>
          <li><a href="https://es.quarkus.io/guides/cdi-integration">ESPAÑOL</a></li>
          <li><a href="https://cn.quarkus.io/guides/cdi-integration">简体中文</a></li>
          <li><a href="https://ja.quarkus.io/guides/cdi-integration">日本語</a></li>
          </ul>
      </li>
      <li>
        <span href="#" class="modeswitcher" id='theme-toggle'><i class="fas
fa-sun"></i><i class="fas fa-moon"></i><i class="fas fa-cog"></i></span>
      </li>
    </ul>
      </nav>
    </div>
  </div>
</div>

  <div class="content">
    







<section class="full-width-version-bg flexfilterbar guides">
  <div class="guideflexcontainer">
    <div class="docslink">
      <a class="returnlink" href="/guides/"> Back to Guides</a>
    </div>
    <div class="flexlabel">
      <label>バージョン:</label>
    </div>
    <div class="guidepulldown version">
    <select id="guide-version-dropdown">
      
        
        
        <option value="main" >Main - SNAPSHOT</option>
        
        
        
        <option value="latest" selected>3.17.6 - Latest</option>
        
        
        
        <option value="3.15" >3.15</option>
        
        
        
        <option value="3.8" >3.8</option>
        
        
        
        <option value="3.2" >3.2</option>
        
        
        
        <option value="2.16" >2.16</option>
        
        
        
        <option value="2.13" >2.13</option>
        </select>
    </div>
  </div>
</section>

<div class="guide">
  <div class="grid-wrapper">
    <div class="grid__item width-8-12 width-12-12-m">
      
      <a class="editlink" href="https://github.com/quarkusio/quarkus/edit/main/docs/src/main/asciidoc/cdi-integration.adoc">このページを編集</a>
      
      <h1 class="text-caps">CDI 統合ガイド </h1>
      <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>ArC, the CDI container in Quarkus, is bootstrapped at build time.
To integrate with the container, <a href="https://jakarta.ee/specifications/cdi/4.1/jakarta-cdi-spec-4.1.html#spi_lite" target="_blank" rel="noopener">CDI Build Compatible Extensions</a> can be used, as well as a Quarkus-specific extension API.
CDI Portable Extensions are not and cannot be supported.
This guide focuses on the Quarkus-specific extensions API.</p>
</div>
<div class="paragraph">
<p>コンテナーは複数のフェーズでブートストラップされます。高レベルの視点から見ると、これらのフェーズは以下のようになります。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>初期化</p>
</li>
<li>
<p>Beanディスカバリ</p>
</li>
<li>
<p>合成コンポーネントの登録</p>
</li>
<li>
<p>バリデーション</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><em>初期化</em> フェーズでは、準備作業が行われ、カスタムコンテキストが登録されます。その後、コンテナーがすべてのアプリケーションクラスを分析し、Beanを識別し、提供されたメタデータに基づいてそれらをすべて繋ぎ合わせるプロセスがBean <em>ディスカバリ</em> です。その後、エクステンションは <em>合成コンポーネント</em> を登録することができます。これらのコンポーネントの属性はエクステンションによって完全に制御されます。最後に、 <em>デプロイメントが検証されます</em> 。例えば、コンテナーはアプリケーション内のすべての注入ポイントを検証し、与えられた必要な型と修飾子を満たすBeanがない場合はビルドを失敗させます。</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can see more information about the bootstrap by enabling additional logging. Simply run the Maven build with <code>-X</code> or <code>--debug</code> and grep the lines that contain <code>io.quarkus.arc</code>. In <a href="cdi-reference#dev_mode">dev mode</a>, you can use <code>quarkus.log.category."io.quarkus.arc.processor".level=DEBUG</code> and two special endpoints are also registered automatically to provide some basic debug info in the JSON format.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Quarkusのビルドステップでは、さまざまなビルドアイテムを生成したり消費したりして、各フェーズにフックすることができます。以下のセクションでは、関連するすべてのビルド項目と一般的なシナリオについて説明します。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="metadata-sources"><a class="anchor" href="#metadata-sources"></a>1. メタデータソース</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Classes and annotations are the primary source of bean-level metadata.
The initial metadata are read from the <em>bean archive index</em>, an immutable <a href="https://github.com/smallrye/jandex" target="_blank" rel="noopener">Jandex index</a> which is built from various sources during <a href="cdi-reference#bean_discovery">bean discovery</a>.
However, extensions can add, remove or transform the metadata at certain stages of the bootstrap.
Moreover, extensions can also register <a href="#synthetic_beans">synthetic components</a>.
This is an important aspect to realize when integrating CDI components in Quarkus.</p>
</div>
<div class="paragraph">
<p>このようにして、エクステンションは、そうでなければ無視されていたクラスをBeanに変えたり、その逆を行ったりすることができます。例えば、 <code>@Scheduled</code> メソッドを宣言するクラスは、たとえそれがBean定義アノテーションでアノテーションされておらず、通常は無視されるようなクラスであっても、常にBeanとして登録されます。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="use-case-my-class-is-not-recognized-as-a-bean"><a class="anchor" href="#use-case-my-class-is-not-recognized-as-a-bean"></a>2. ユースケース - クラスがBeanとして認識されません</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>UnsatisfiedResolutionException</code> は、 <a href="cdi.html#typesafe_resolution">タイプセーフ解決</a> 時に問題があることを示しています。クラスパス上にインジェクションが可能なクラスがあっても、インジェクションポイントを満たすことができないことがあります。クラスが認識されない理由はいくつかありますが、それを解決する方法もいくつかあります。最初のステップでは、その <em>理由</em> を特定する必要があります。</p>
</div>
<div class="sect2">
<h3 id="additional_bean_build_item"><a class="anchor" href="#additional_bean_build_item"></a>2.1. <em>理由1</em> :クラスが発見されない</h3>
<div class="paragraph">
<p>Quarkusには <a href="cdi-reference.html#bean_discovery">簡易ディスカバリー</a> があります。クラスがアプリケーションのインデックスに含まれていないことが起こるかもしれません。例えば、Quarkusエクステンションの <em>ランタイムモジュール</em> のクラスは自動的にインデックス化されません。</p>
</div>
<div class="paragraph">
<p><em>解決策</em> 。 <code>AdditionalBeanBuildItem</code> .このビルド項目は、ディスカバリー中に解析する1つ以上の追加クラスを指定するために使用することができます。追加のBean・クラスは、コンテナーによって処理されるアプリケーション・インデックスに透過的に追加されます。</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<a href="cdi-reference#enable_build_profile">cdi-reference</a> および <a href="cdi-reference#enable_build_properties">cdi-reference</a> で説明されているように、 <code>@IfBuildProfile</code>, <code>@UnlessBuildProfile</code>, <code>@IfBuildProperty</code> および <code>@UnlessBuildProperty</code> アノテーションを介して、条件付きで追加のBeanを有効化/無効化することはできません。エクステンションは、設定または現在のプロファイルを検査し、本当に必要な場合にのみ <code>AdditionalBeanBuildItem</code> を生成するべきです。
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title"><code>AdditionalBeanBuildItem</code> の例</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BuildStep
AdditionalBeanBuildItem additionalBeans() {
     return new AdditionalBeanBuildItem(SmallRyeHealthReporter.class, HealthServlet.class); <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>AdditionalBeanBuildItem.Builder</code> は、より複雑なユースケースに使用することができます。</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>AdditionalBeanBuildItem</code> 経由で追加された Bean クラスは、デフォルトでは <em>取り外し可能です</em> 。コンテナーがそれらを <a href="cdi-reference.html#remove_unused_beans">未使用</a> とみなした場合、それらはただ無視されます。しかし、 <code>AdditionalBeanBuildItem.Builder.setUnremovable()</code> メソッドを使用して、このビルド項目を介して登録されたBeanクラスを絶対に削除しないようにコンテナーに指示することができます。詳細は、未使用のBeanの <a href="cdi-reference.html#remove_unused_beans">削除</a> と <a href="#unremovable_builditem">[unremovable_builditem</a>] も参照してください。</p>
</div>
<div class="paragraph">
<p><code>AdditionalBeanBuildItem.Builder#setDefaultScope()</code> からデフォルトのスコープを設定することも可能です。デフォルトのスコープは、Beanクラスにスコープが宣言されていない場合にのみ使用されます。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
デフォルトスコープが指定されていない場合は <code>@Dependent</code> 擬似スコープが使用されます。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="reason-2-class-is-discovered-but-has-no-bean-defining-annotation"><a class="anchor" href="#reason-2-class-is-discovered-but-has-no-bean-defining-annotation"></a>2.2. <em>理由2</em> : クラスは発見されたが、Beanを定義するアノテーションがない</h3>
<div class="paragraph">
<p>In Quarkus, the application is represented by a single bean archive with the <a href="https://jakarta.ee/specifications/cdi/4.1/jakarta-cdi-spec-4.1.html#default_bean_discovery" target="_blank" rel="noopener">bean discovery mode <code>annotated</code></a>.
Therefore, bean classes that don&#8217;t have a <a href="https://jakarta.ee/specifications/cdi/4.1/jakarta-cdi-spec-4.1.html#bean_defining_annotations" target="_blank" rel="noopener">bean defining annotation</a> are ignored.
Bean defining annotations are declared on the class-level and include scopes, stereotypes and <code>@Interceptor</code>.</p>
</div>
<div class="paragraph">
<p><em>解決策1</em> : <code>AutoAddScopeBuildItem</code> の使用。このビルドアイテムを使用すると、特定の条件を満たすクラスにスコープを追加することができます。</p>
</div>
<div class="listingblock">
<div class="title"><code>AutoAddScopeBuildItem</code> の例</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BuildStep
AutoAddScopeBuildItem autoAddScope() {
   return AutoAddScopeBuildItem.builder().containsAnnotations(SCHEDULED_NAME, SCHEDULES_NAME) <i class="conum" data-value="1"></i><b>(1)</b>
      .defaultScope(BuiltinScope.SINGLETON) <i class="conum" data-value="2"></i><b>(2)</b>
      .build();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>@Scheduled</code> でアノテーションされたすべてのクラスを検索</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>デフォルトのスコープとして <code>@Singleton</code> を追加。既にスコープでアノテーションされているクラスは自動的にスキップされます。</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>解決策2</em>: 特定のアノテーションが付けられたクラスを処理する必要がある場合は、<code>BeanDefiningAnnotationBuildItem</code> を介して Bean 定義アノテーションのセットを拡張することができます。</p>
</div>
<div class="listingblock">
<div class="title"><code>BeanDefiningAnnotationBuildItem</code> の例</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BuildStep
BeanDefiningAnnotationBuildItem additionalBeanDefiningAnnotation() {
   return new BeanDefiningAnnotationBuildItem(Annotations.GRAPHQL_API); <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Bean 定義アノテーションのセットに <code>org.eclipse.microprofile.graphql.GraphQLApi</code> を追加します。</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>BeanDefiningAnnotationBuildItem</code> を介して追加された Bean クラスは、デフォルトでは <em>削除不可</em> です。したがって、結果の Bean は未使用と見なされても削除しないでください。ただし、デフォルトの動作は変更できます。詳細については<a href="cdi-reference#remove_unused_beans">Removing Unused Beans</a> および<a href="#unremovable_builditem"><em>理由3</em>: クラスが検出され、Bean 定義のアノテーションがあるが削除された</a> を参照してください。</p>
</div>
<div class="paragraph">
<p>デフォルトスコープを設定することもできます。デフォルトスコープは、Bean クラスにスコープが宣言されていない場合にのみ使用されます。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
デフォルトスコープが指定されていない場合は <code>@Dependent</code> 擬似スコープが使用されます。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="unremovable_builditem"><a class="anchor" href="#unremovable_builditem"></a>2.3. <em>理由3</em>: クラスが検出され、Bean 定義のアノテーションがあるが削除された</h3>
<div class="paragraph">
<p>デフォルトで、コンテナーはビルド時に <a href="cdi-reference#remove_unused_beans">remove all unused beans</a> を試行します。この最適化により、<em>フレームワークレベルでのデッドコードの排除</em> が可能になります。いくつかの特殊なケースでは、未使用の Bean を正しく特定できません。特に、Quarkus はまだ <code>CDI.current()</code> 静的メソッドの使用を検出できません。エクステンションは、<code>UnremovableBeanBuildItem</code> を生成することで、誤検出の可能性をなくすことができます。</p>
</div>
<div class="listingblock">
<div class="title"><code>UnremovableBeanBuildItem</code> の例</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BuildStep
UnremovableBeanBuildItem unremovableBeans() {
   return UnremovableBeanBuildItem.targetWithAnnotation(STARTUP_NAME); <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>@Startup</code> でアノテーションされたすべてのクラスを削除できないようにする。</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="use-case-my-annotation-is-not-recognized-as-a-qualifier-or-an-interceptor-binding"><a class="anchor" href="#use-case-my-annotation-is-not-recognized-as-a-qualifier-or-an-interceptor-binding"></a>3. ユースケース - アノテーションが修飾子またはインターセプターバインディングとして認識されない</h2>
<div class="sectionbody">
<div class="paragraph">
<p>アノテーションクラスがアプリケーションインデックスに含まれていない可能性があります。たとえば、Quarkus エクステンションの <em>ランタイムモジュール</em> のクラスは自動的にインデックス化されません。</p>
</div>
<div class="paragraph">
<p><em>解決策</em>: <a href="#additional_bean_build_item"><em>理由1</em> :クラスが発見されない</a> で説明されているとおりに <code>AdditionalBeanBuildItem</code> を使用します。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="annotations_transformer_build_item"><a class="anchor" href="#annotations_transformer_build_item"></a>4. ユースケース - アノテーションのメタデータを変換する必要がある場合</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In some cases, it&#8217;s useful to be able to modify the annotation metadata.
Quarkus provides a powerful alternative to <a href="https://jakarta.ee/specifications/cdi/4.1/jakarta-cdi-spec-4.1.html#process_annotated_type" target="_blank" rel="noopener"><code>jakarta.enterprise.inject.spi.ProcessAnnotatedType</code></a> and <a href="https://jakarta.ee/specifications/cdi/4.1/jakarta-cdi-spec-4.1.html#bce_enhancement" target="_blank" rel="noopener"><code>jakarta.enterprise.inject.build.compatible.spi.Enhancement</code></a>.
With an <code>AnnotationsTransformerBuildItem</code> it&#8217;s possible to override the annotations that exist on bean classes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
アノテーショントランスフォーマーは、Beanディスカバリが始まる <em>前に</em> 生成されなければならないことを覚えておいてください。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example, you might want to add an interceptor binding to a specific bean class.
You can use a convenient builder API to create a transformation instance:</p>
</div>
<div class="listingblock">
<div class="title">Builder Example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BuildStep
AnnotationsTransformerBuildItem transform() {
    return new AnnotationsTransformerBuildItem(AnnotationTransformation.forClasses() <i class="conum" data-value="1"></i><b>(1)</b>
        .whenClass(DotName.createSimple("org.acme.Bar")) <i class="conum" data-value="2"></i><b>(2)</b>
        .transform(t -&gt; t.add(MyInterceptorBinding.class))); <i class="conum" data-value="3"></i><b>(3)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>トランスフォーマーはクラスにのみ適用されます。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Only apply the transformation if the class is <code>org.acme.Bar</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>@MyInterceptorBinding</code> アノテーションを追加します。</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The example above can be rewritten with an anonymous class:</p>
</div>
<div class="listingblock">
<div class="title"><code>AnnotationsTransformerBuildItem</code> の例</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BuildStep
AnnotationsTransformerBuildItem transform() {
    return new AnnotationsTransformerBuildItem(new AnnotationTransformation() {
        public boolean supports(AnnotationTarget.Kind kind) {
            return kind == AnnotationTarget.Kind.CLASS; <i class="conum" data-value="1"></i><b>(1)</b>
        }

        public void apply(TransformationContext context) {
            if (context.declaration().asClass().name().toString().equals("org.acme.Bar")) {
                context.add(MyInterceptorBinding.class); <i class="conum" data-value="2"></i><b>(2)</b>
            }
        }
    });
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>トランスフォーマーはクラスにのみ適用されます。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>If the class name equals to <code>org.acme.Bar</code> then add <code>@MyInterceptorBinding</code>.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The previous <code>AnnotationsTransformer</code> API from ArC is still supported, but the new <code>AnnotationTransformation</code> API from Jandex is preferred.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>ビルドステップでは、<code>TransformedAnnotationsBuildItem</code> を介して、特定のアノテーションターゲットの変換済みアノテーションをクエリーできます。</p>
</div>
<div class="listingblock">
<div class="title"><code>TransformedAnnotationsBuildItem</code> の例</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BuildStep
void queryAnnotations(TransformedAnnotationsBuildItem transformedAnnotations,
        BuildProducer&lt;MyBuildItem&gt; myBuildItem) {
    ClassInfo myClazz = ...;
    if (transformedAnnotations.getAnnotations(myClazz).isEmpty()) { <i class="conum" data-value="1"></i><b>(1)</b>
        myBuildItem.produce(new MyBuildItem());
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>TransformedAnnotationsBuildItem.getAnnotations()</code> は、変換された可能性のあるアノテーションのセットを返します。</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
変換に特化した他のビルドアイテム (<a href="#additional_interceptor_bindings">ユースケース - 追加のインターセプターバインディング</a> および<a href="#injection_point_transformation">ユースケース - インジェクションポイントの変換</a>) もあります。
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="how-to-enable-trace-logging-for-annotation-transformers"><a class="anchor" href="#how-to-enable-trace-logging-for-annotation-transformers"></a>4.1. Annotation TransformerのTrace Loggingを有効にする方法</h3>
<div class="paragraph">
<p> <code>io.quarkus.arc.processor</code> のカテゴリーに <code>TRACE</code> レベルを設定し、その後、ログ出力の解析を試みてください。</p>
</div>
<div class="listingblock">
<div class="title"><code>application.properties</code> の例</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.log.category."io.quarkus.arc.processor".min-level=TRACE <i class="conum" data-value="1"></i><b>(1)</b>
quarkus.log.category."io.quarkus.arc.processor".level=TRACE</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>また、関連するカテゴリーの最小ログレベルを調整する必要があります。</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="inspect_beans"><a class="anchor" href="#inspect_beans"></a>5. ユースケース - Bean、オブザーバー、インジェクションポイントの検査</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="solution-1-beandiscoveryfinishedbuilditem"><a class="anchor" href="#solution-1-beandiscoveryfinishedbuilditem"></a>5.1. <em>解決策1.</em> <code>BeanDiscoveryFinishedBuildItem</code></h3>
<div class="paragraph">
<p><code>BeanDiscoveryFinishedBuildItem</code> のコンシューマーは、アプリケーションに登録されているすべてのクラスベースの Bean、オブザーバー、およびインジェクションポイントを簡単に検査できます。ただし、このビルドアイテムは合成コンポーネントが登録される <em>前</em> に作成されるため、合成 Bean とオブザーバーは <em>含まれません</em> 。</p>
</div>
<div class="paragraph">
<p>さらに、<code>BeanDiscoveryFinishedBuildItem#getBeanResolver()</code> から返された Bean リゾルバーを使用して、タイプセーフな解決ルールを適用できます。たとえば、必要な型と修飾子の特定の組み合わせを満たす Bean があるかどうかを確認できます。</p>
</div>
<div class="listingblock">
<div class="title"><code>BeanDiscoveryFinishedBuildItem</code> の例</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BuildStep
void doSomethingWithNamedBeans(BeanDiscoveryFinishedBuildItem beanDiscovery, BuildProducer&lt;NamedBeansBuildItem&gt; namedBeans) {
   List&lt;BeanInfo&gt; namedBeans = beanDiscovery.beanStream().withName().collect(toList())); <i class="conum" data-value="1"></i><b>(1)</b>
   namedBeans.produce(new NamedBeansBuildItem(namedBeans));
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>結果のリストに <code>@Named</code> 合成 Bean は含まれません。</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="solution-2-synthesisfinishedbuilditem"><a class="anchor" href="#solution-2-synthesisfinishedbuilditem"></a>5.2. <em>解決策2</em> : <code>SynthesisFinishedBuildItem</code></h3>
<div class="paragraph">
<p><code>SynthesisFinishedBuildItem</code> のコンシューマーは、アプリケーションに登録されているすべての Bean、オブザーバー、およびインジェクションポイントを簡単に検査できます。このビルドアイテムは合成コンポーネントが登録された <em>後</em> に作成されるため、合成 Bean とオブザーバーも <em>含まれます</em> 。</p>
</div>
<div class="paragraph">
<p>さらに、<code>SynthesisFinishedBuildItem#getBeanResolver()</code> から返された Bean リゾルバーを使用して、タイプセーフな解決ルールを適用できます。たとえば、必要な型と修飾子の特定の組み合わせを満たす Bean があるかどうかを確認できます。</p>
</div>
<div class="listingblock">
<div class="title"><code>SynthesisFinishedBuildItem</code> の例</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BuildStep
void doSomethingWithNamedBeans(SynthesisFinishedBuildItem synthesisFinished, BuildProducer&lt;NamedBeansBuildItem&gt; namedBeans) {
   List&lt;BeanInfo&gt; namedBeans = synthesisFinished.beanStream().withName().collect(toList())); <i class="conum" data-value="1"></i><b>(1)</b>
   namedBeans.produce(new NamedBeansBuildItem(namedBeans));
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>結果のリストには、<code>@Named</code> 合成 Bean が含まれます。</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="synthetic_beans"><a class="anchor" href="#synthetic_beans"></a>6. ユースケース - 合成 Bean の必要性</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sometimes it is practical to be able to register a <em>synthetic bean</em>.
Bean attributes of a synthetic bean are not derived from a Java class, method or field.
Instead, all the attributes are defined by an extension.
In regular CDI, this could be achieved using the <a href="https://jakarta.ee/specifications/cdi/4.1/jakarta-cdi-spec-4.1.html#after_bean_discovery" target="_blank" rel="noopener"><code>AfterBeanDiscovery.addBean()</code></a> and <a href="https://jakarta.ee/specifications/cdi/4.1/jakarta-cdi-spec-4.1.html#bce_synthesis"><code>SyntheticComponents.addBean()</code></a> methods.</p>
</div>
<div class="paragraph">
<p><em>解決策</em>: 合成 Bean を登録する必要がある場合は、<code>SyntheticBeanBuildItem</code> を使用します。</p>
</div>
<div class="listingblock">
<div class="title"><code>SyntheticBeanBuildItem</code> の例 1</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BuildStep
SyntheticBeanBuildItem syntheticBean() {
   return SyntheticBeanBuildItem.configure(String.class)
             .qualifiers(AnnotationInstance.builder(MyQualifier.class).build())
             .creator(mc -&gt; mc.returnValue(mc.load("foo"))) <i class="conum" data-value="1"></i><b>(1)</b>
             .done();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Generate the bytecode of the <code>jakarta.enterprise.context.spi.Contextual#create(CreationalContext&lt;T&gt;)</code> implementation.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Bean Configurator の出力は、バイトコードとして記録されます。したがって、実行時に合成 Bean インスタンスを作成する方法にはいくつかの制限があります。以下が可能です。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Contextual#create(CreationalContext&lt;T&gt;)</code> メソッドのバイトコードを、<code>ExtendedBeanConfigurator.creator(Consumer&lt;MethodCreator&gt;)</code> を介して直接生成します。</p>
</li>
<li>
<p>Pass a subclass of <code>io.quarkus.arc.BeanCreator</code> via <code>ExtendedBeanConfigurator#creator(Class&lt;? extends BeanCreator&lt;U&gt;&gt;)</code>, and possibly specify some build-time parameters via <code>ExtendedBeanConfigurator#param()</code> and synthetic injection points via <code>ExtendedBeanConfigurator#addInjectionPoint()</code>.</p>
</li>
<li>
<p>Produce the runtime instance through a proxy returned from a <a href="writing-extensions#bytecode-recording"><code>@Recorder</code> method</a> and set it via <code>ExtendedBeanConfigurator#runtimeValue(RuntimeValue&lt;?&gt;)</code>, <code>ExtendedBeanConfigurator#runtimeProxy(Object)</code>,  <code>ExtendedBeanConfigurator#supplier(Supplier&lt;?&gt;)</code> or <code>ExtendedBeanConfigurator#createWith(Function&lt;SyntheticCreationalContext&lt;?&gt;, &lt;?&gt;)</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title"><code>SyntheticBeanBuildItem</code> の例 2</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BuildStep
@Record(STATIC_INIT) <i class="conum" data-value="1"></i><b>(1)</b>
SyntheticBeanBuildItem syntheticBean(TestRecorder recorder) {
   return SyntheticBeanBuildItem.configure(Foo.class).scope(Singleton.class)
                .runtimeValue(recorder.createFoo()) <i class="conum" data-value="2"></i><b>(2)</b>
                .done();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>デフォルトでは、合成 Bean は <code>STATIC_INIT</code> の間に初期化されます。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Bean インスタンスは、レコーダーメソッドから返される値によって提供されます。</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is also possible to create a generic synthetic bean <code>Foo&lt;Bar&gt;</code>.</p>
</div>
<div class="listingblock">
<div class="title"><code>SyntheticBeanBuildItem</code> Example 3</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BuildStep
@Record(STATIC_INIT)
SyntheticBeanBuildItem syntheticBean(TestRecorder recorder) {
   return SyntheticBeanBuildItem.configure(Foo.class)
                .types(ParameterizedType.create(Foo.class, ClassType.create(Bar.class)))) <i class="conum" data-value="1"></i><b>(1)</b>
                .scope(Singleton.class)
                .runtimeValue(recorder.createFooBar())
                .done();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>types()</code> or <code>addType()</code> must be used to specify the generic type.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>RUNTIME_INIT</code> の間に初期化される合成 Bean をマークできます。<code>STATIC_INIT</code> と <code>RUNTIME_INIT</code> の違いの詳細については、<a href="writing-extensions#bootstrap-three-phases">Three Phases of Bootstrap and Quarkus Philosophy</a> を参照してください。</p>
</div>
<div class="listingblock">
<div class="title"><code>RUNTIME_INIT</code> <code>SyntheticBeanBuildItem</code> の例</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BuildStep
@Record(RUNTIME_INIT) <i class="conum" data-value="1"></i><b>(1)</b>
SyntheticBeanBuildItem syntheticBean(TestRecorder recorder) {
   return SyntheticBeanBuildItem.configure(Foo.class).scope(Singleton.class)
                .setRuntimeInit() <i class="conum" data-value="2"></i><b>(2)</b>
                .runtimeValue(recorder.createFoo())
                .done();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>レコーダーは、<code>ExecutionTime.RUNTIME_INIT</code> フェーズで実行する必要があります。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Bean インスタンスは、<code>RUNTIME_INIT</code> の間に初期化されます。</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>RUNTIME_INIT</code> の間に初期化された合成 Bean は、<code>STATIC_INIT</code> の間にアクセスしてはいけません。runtime-init 合成 Bean にアクセスする <code>RUNTIME_INIT</code> ビルドステップは、<code>SyntheticBeansRuntimeInitBuildItem</code> を消費します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BuildStep
@Record(RUNTIME_INIT)
@Consume(SyntheticBeansRuntimeInitBuildItem.class) <i class="conum" data-value="1"></i><b>(1)</b>
void accessFoo(TestRecorder recorder) {
   recorder.foo(); <i class="conum" data-value="2"></i><b>(2)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>このビルドステップは、<code>syntheticBean()</code> の完了後に実行する必要があります。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>このレコーダーメソッドでは <code>Foo</code> Bean インスタンスが呼び出されるため、必ずすべての合成 Bean が初期化された後にビルドステップが実行されることを確認する必要があります。</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>BeanRegistrationPhaseBuildItem</code> を使用して合成 Bean を登録することもできます。ただし、エクステンション作成者においては、Quarkus にとってより慣用的な <code>SyntheticBeanBuildItem</code> を使用することをお勧めします。
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="synthetic-injection-points"><a class="anchor" href="#synthetic-injection-points"></a>6.1. Synthetic Injection Points</h3>
<div class="paragraph">
<p>A synthetic bean may register a synthetic injection point via the <code>ExtendedBeanConfigurator#addInjectionPoint()</code> method.
This injection point is validated at build time and considered when <a href="cdi-reference#remove_unused_beans">detecting unused beans</a>.
The injected reference is accessible through the <code>SyntheticCreationalContext#getInjectedReference()</code> methods at runtime.</p>
</div>
<div class="listingblock">
<div class="title">Synthetic Injection Point - Build Step Example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.jboss.jandex.ClassType;
import org.jboss.jandex.DotName;

@BuildStep
@Record(RUNTIME_INIT) <i class="conum" data-value="1"></i><b>(1)</b>
SyntheticBeanBuildItem syntheticBean(TestRecorder recorder) {
   return SyntheticBeanBuildItem.configure(Foo.class)
                .scope(Singleton.class)
                .addInjectionPoint(ClassType.create(DotName.createSimple(Bar.class))) <i class="conum" data-value="2"></i><b>(2)</b>
                .createWith(recorder.createFoo()) <i class="conum" data-value="3"></i><b>(3)</b>
                .done();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Bean インスタンスは、<code>RUNTIME_INIT</code> の間に初期化されます。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>A synthetic injection point with required type <code>Bar</code> was added; this is an equivalent of <code>@Inject Bar</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The bean instance is created with a function returned from a recorder method.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Synthetic Injection Point - Recorder Example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Recorder
public class TestRecorder {

   public Function&lt;SyntheticCreationalContext&lt;Foo&gt;, Foo&gt; createFoo() {
     return (context) -&gt; {
        return new Foo(context.getInjectedReference(Bar.class)); <i class="conum" data-value="1"></i><b>(1)</b>
     };
   }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Pass a contextual reference of <code>Bar</code> to the constructor of <code>Foo</code>.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="inactive-synthetic-beans"><a class="anchor" href="#inactive-synthetic-beans"></a>6.2. Inactive Synthetic Beans</h3>
<div class="paragraph">
<p>In the case when one needs to register multiple synthetic beans at build time but only wants a subset of them active at runtime, it is useful to be able to mark a synthetic bean as <em>inactive</em>.
This is done by configuring a "check active" procedure, which should be a <code>Supplier&lt;ActiveResult&gt;</code> obtained from a recorder:</p>
</div>
<div class="listingblock">
<div class="title">Inactive Synthetic Bean - Build Step Example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BuildStep
@Record(RUNTIME_INIT)
SyntheticBeanBuildItem syntheticBean(TestRecorder recorder) {
    return SyntheticBeanBuildItem.configure(Foo.class)
            .scope(Singleton.class)
            .startup() <i class="conum" data-value="1"></i><b>(1)</b>
            .checkActive(recorder.isFooActive()) <i class="conum" data-value="2"></i><b>(2)</b>
            .createWith(recorder.createFoo())
            .done();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>A bean that might be inactive is typically initialized eagerly, to make sure that an error is thrown at application startup.
If the bean is in fact inactive, but is not injected into an always-active bean, eager initialization is skipped and no error is thrown.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Configures the "check active" procedure.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Inactive Synthetic Bean - Recorder Example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Recorder
public class TestRecorder {
    public Supplier&lt;ActiveResult&gt; isFooActive() {
        return () -&gt; {
            if (... should not be active ...) { <i class="conum" data-value="1"></i><b>(1)</b>
                return ActiveResult.inactive("explanation"); <i class="conum" data-value="2"></i><b>(2)</b>
            }
            return ActiveResult.active();
        };
    }

    public Function&lt;SyntheticCreationalContext&lt;Foo&gt;, Foo&gt; createFoo() {
        return (context) -&gt; {
            return new Foo();
        };
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The condition when the synthetic bean should be inactive.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Proper explanation of why the bean is inactive.
Another inactive <code>ActiveResult</code> may also be provided as a cause, if this bean&#8217;s inactivity stems from another bean&#8217;s inactivity.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If an inactive bean is injected somewhere, or is dynamically looked up, an <code>InactiveBeanException</code> is thrown.
The error message contains the reason (from the <code>ActiveResult</code>), the cause chain (also from the <code>ActiveResult</code>), and possibly also a list of all injection points that resolve to this bean.</p>
</div>
<div class="paragraph">
<p>If you want to handle the inactive case gracefully, you should always inject possibly inactive beans using <code>Instance&lt;&gt;</code>.
You also need to check before obtaining the actual instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import io.quarkus.arc.InjectableInstance;

@Inject
InjectableInstance&lt;Foo&gt; foo;

if (foo.getHandle().getBean().isActive()) {
    Foo foo = foo.get();
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to consume only active beans, you can inject an <code>InjectableInstance&lt;&gt;</code> and call <code>getActive()</code> to get the single instance or <code>listActive()</code> to get all instances:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import io.quarkus.arc.InjectableInstance;

@Inject
@Any
InjectableInstance&lt;Foo&gt; foos;

for (Foo foo : foos.listActive())
    ...
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="synthetic_observers"><a class="anchor" href="#synthetic_observers"></a>7. ユースケース - 合成オブザーバー</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="#synthetic_beans">synthetic beans</a> と同様に、合成オブザーバーメソッドの属性は Java メソッドから派生しません。代わりに、すべての属性がエクステンションによって定義されます。</p>
</div>
<div class="paragraph">
<p><em>解決策</em>: 合成オブザーバーを登録する必要がある場合は、<code>ObserverRegistrationPhaseBuildItem</code> を使用します。</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<code>ObserverRegistrationPhaseBuildItem</code> を消費するビルドステップでは、常に <code>ObserverConfiguratorBuildItem</code> を生成するか、少なくともこのビルドアイテムに <code>BuildProducer</code> を 挿入する必要があります。でなければ、無視されるか、間違ったタイミングで処理される可能性があります (例: 正しい CDI ブートストラップフェーズの後)。
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title"><code>ObserverRegistrationPhaseBuildItem</code> の例</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BuildStep
void syntheticObserver(ObserverRegistrationPhaseBuildItem observerRegistrationPhase,
            BuildProducer&lt;MyBuildItem&gt; myBuildItem,
            BuildProducer&lt;ObserverConfiguratorBuildItem&gt; observerConfigurationRegistry) {
   observerConfigurationRegistry.produce(new ObserverConfiguratorBuildItem(observerRegistrationPhase.getContext()
       .configure()
       .beanClass(DotName.createSimple(MyBuildStep.class.getName()))
       .observedType(String.class)
       .notify(mc -&gt; {
           // do some gizmo bytecode generation...
       })));
   myBuildItem.produce(new MyBuildItem());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>ObserverConfigurator</code> の出力はバイトコードとして記録されます。したがって、実行時に合成オブザーバーを呼び出す方法にはいくつかの制限があります。現時点では、メソッド本体のバイトコードを直接生成する必要があります。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="generated_beans"><a class="anchor" href="#generated_beans"></a>8. ユースケース - 生成された Bean クラスがある</h2>
<div class="sectionbody">
<div class="paragraph">
<p>問題ありません。Bean クラスのバイトコードを手動で生成し、その後に <code>GeneratedClassBuildItem</code> ではなく <code>GeneratedBeanBuildItem</code> を生成してください。</p>
</div>
<div class="listingblock">
<div class="title"><code>GeneratedBeanBuildItem</code> の例</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BuildStep
void generatedBean(BuildProducer&lt;GeneratedBeanBuildItem&gt; generatedBeans) {
    ClassOutput beansClassOutput = new GeneratedBeanGizmoAdaptor(generatedBeans); <i class="conum" data-value="1"></i><b>(1)</b>
    ClassCreator beanClassCreator = ClassCreator.builder().classOutput(beansClassOutput)
                .className("org.acme.MyBean")
                .build();
    beanClassCreator.addAnnotation(Singleton.class);
    beanClassCreator.close(); <i class="conum" data-value="2"></i><b>(2)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>io.quarkus.arc.deployment.GeneratedBeanGizmoAdaptor</code> を使用すると、Gizmo コンストラクトから <code>GeneratedBeanBuildItem</code> を簡単に作成できます。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>結果の Bean クラスは、次のようになります: <code>public class @Singleton MyBean { }</code>。</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="use-case-i-need-to-validate-the-deployment"><a class="anchor" href="#use-case-i-need-to-validate-the-deployment"></a>9. ユースケース - デプロイメントを検証する必要がある</h2>
<div class="sectionbody">
<div class="paragraph">
<p>エクステンションは、Bean、オブザーバー、およびインジェクションポイントを検査し、さらに追加の検証を実行して、何か問題がある場合はビルドを失敗にする必要があります。</p>
</div>
<div class="paragraph">
<p><em>解決策</em>: エクステンションがデプロイメントを検証する必要がある場合、<code>ValidationPhaseBuildItem</code> を使用します。</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<code>ValidationPhaseBuildItem</code> を消費するビルドステップでは、常に <code>ValidationErrorBuildItem</code> を生成するか、少なくともこのビルドアイテムに <code>BuildProducer</code> を 挿入する必要があります。でなければ、無視されるか、間違ったタイミングで処理される可能性があります (例: 正しい CDI ブートストラップフェーズの後)。
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BuildStep
void validate(ValidationPhaseBuildItem validationPhase,
            BuildProducer&lt;MyBuildItem&gt; myBuildItem,
            BuildProducer&lt;ValidationErrorBuildItem&gt; errors) {
   if (someCondition) {
     errors.produce(new ValidationErrorBuildItem(new IllegalStateException()));
     myBuildItem.produce(new MyBuildItem());
   }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<code>ValidationPhaseBuildItem.getContext().beans()</code> メソッドから返される便利な <code>BeanStream</code> を使用して、登録されているすべての Bean を簡単にフィルタリングできます。
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="custom_context"><a class="anchor" href="#custom_context"></a>10. ユースケース - カスタム CDI コンテキストの登録</h2>
<div class="sectionbody">
<div class="paragraph">
<p>時々、エクステンションは組み込みCDI コンテキストのセットを拡張する必要があります。</p>
</div>
<div class="paragraph">
<p><em>解決策</em>: カスタムコンテキストを登録する必要がある場合は、<code>ContextRegistrationPhaseBuildItem</code> を使用します。</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<code>ContextRegistrationPhaseBuildItem</code> を消費するビルドステップでは、常に <code>ContextConfiguratorBuildItem</code> を生成するか、少なくともこのビルドアイテムに `BuildProducer`を 挿入する必要があります。でなければ、無視されるか、間違ったタイミングで処理される可能性があります (例: 正しい CDI ブートストラップフェーズの後)。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>ContextRegistrationPhaseBuildItem</code> の例</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BuildStep
ContextConfiguratorBuildItem registerContext(ContextRegistrationPhaseBuildItem phase) {
      return new ContextConfiguratorBuildItem(phase.getContext().configure(TransactionScoped.class).normal().contextClass(TransactionContext.class));
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>さらに、<code>ContextRegistrationPhaseBuildItem</code> を介してカスタム CDI コンテキストを登録する各エクステンションは、Bean 定義アノテーションのセットにカスタムスコープアノテーション名を提供するために、<code>CustomScopeBuildItem</code> も生成する必要があります。</p>
</div>
<div class="paragraph">
<p><code>CustomScopeBuildItem</code> の例</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BuildStep
CustomScopeBuildItem customScope() {
   return new CustomScopeBuildItem(DotName.createSimple(TransactionScoped.class.getName()));
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="what-if-i-need-to-know-all-the-scopes-used-in-the-application"><a class="anchor" href="#what-if-i-need-to-know-all-the-scopes-used-in-the-application"></a>10.1. アプリケーションで使用されているすべてのスコープを知る必要がある場合はどうなりますか?</h3>
<div class="paragraph">
<p><em>ソリューション</em>: ビルドステップで <code>CustomScopeAnnotationsBuildItem</code> を挿入し、 <code>CustomScopeAnnotationsBuildItem.isScopeDeclaredOn()</code> などの便利なメソッドを使用できます。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="additional_interceptor_bindings"><a class="anchor" href="#additional_interceptor_bindings"></a>11. ユースケース - 追加のインターセプターバインディング</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In rare cases it might be handy to programmatically register an existing annotation that is not annotated with <code>@jakarta.interceptor.InterceptorBinding</code> as an interceptor binding.
This is similar to what CDI achieves through <code>BeforeBeanDiscovery#addInterceptorBinding()</code>.
We are going to use <code>InterceptorBindingRegistrarBuildItem</code> to get it done.</p>
</div>
<div class="listingblock">
<div class="title"><code>InterceptorBindingRegistrarBuildItem</code> の例</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BuildStep
InterceptorBindingRegistrarBuildItem addInterceptorBindings() {
    return new InterceptorBindingRegistrarBuildItem(new InterceptorBindingRegistrar() {
        @Override
        public List&lt;InterceptorBinding&gt; getAdditionalBindings() {
            return List.of(InterceptorBinding.of(NotAnInterceptorBinding.class));
        }
    });
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="use-case-additional-qualifiers"><a class="anchor" href="#use-case-additional-qualifiers"></a>12. 使用例 - 追加の修飾子</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sometimes it might be useful to register an existing annotation that is not annotated with <code>@jakarta.inject.Qualifier</code> as a CDI qualifier.
This is similar to what CDI achieves through <code>BeforeBeanDiscovery#addQualifier()</code>.
We are going to use <code>QualifierRegistrarBuildItem</code> to get it done.</p>
</div>
<div class="listingblock">
<div class="title"><code>QualifierRegistrarBuildItem</code> の例</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BuildStep
QualifierRegistrarBuildItem addQualifiers() {
    return new QualifierRegistrarBuildItem(new QualifierRegistrar() {
        @Override
        public Map&lt;DotName, Set&lt;String&gt;&gt; getAdditionalQualifiers() {
            return Collections.singletonMap(DotName.createSimple(NotAQualifier.class.getName()),
                                        Collections.emptySet());
        }
    });
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="use-case-additional-stereotypes"><a class="anchor" href="#use-case-additional-stereotypes"></a>13. 使用例 - 追加のステレオタイプ</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is sometimes useful to register an existing annotation that is not annotated with <code>@jakarta.enterprise.inject.Stereotype</code> as a CDI stereotype.
This is similar to what CDI achieves through <code>BeforeBeanDiscovery#addStereotype()</code>.
We are going to use <code>StereotypeRegistrarBuildItem</code> to get it done.</p>
</div>
<div class="listingblock">
<div class="title"><code>StereotypeRegistrarBuildItem</code> の例</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BuildStep
StereotypeRegistrarBuildItem addStereotypes() {
    return new StereotypeRegistrarBuildItem(new StereotypeRegistrar() {
        @Override
        public Set&lt;DotName&gt; getAdditionalStereotypes() {
            return Collections.singleton(DotName.createSimple(NotAStereotype.class.getName()));
        }
    });
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>新しく登録されたステレオタイプアノテーションに、スコープやインターセプターのバインディングなどの適切なメタアノテーションがない場合、 <a href="#annotations_transformer_build_item">アノテーション変換</a> を使用してそれらを追加します。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="injection_point_transformation"><a class="anchor" href="#injection_point_transformation"></a>14. ユースケース - インジェクションポイントの変換</h2>
<div class="sectionbody">
<div class="paragraph">
<p>プログラムでインジェクションポイントの修飾子を変更できると便利な場合があります。それは、<code>InjectionPointTransformerBuildItem</code> で実行できます。次のサンプルは、修飾子 <code>MyQualifier</code> を含むタイプ <code>Foo</code> のインジェクションポイント変換を適用する方法を示しています。</p>
</div>
<div class="listingblock">
<div class="title"><code>InjectionPointTransformerBuildItem</code> の例</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BuildStep
InjectionPointTransformerBuildItem transformer() {
    return new InjectionPointTransformerBuildItem(new InjectionPointsTransformer() {

        public boolean appliesTo(Type requiredType) {
            return requiredType.name().equals(DotName.createSimple(Foo.class.getName()));
        }

        public void transform(TransformationContext context) {
            if (context.getQualifiers().stream()
                    .anyMatch(a -&gt; a.name().equals(DotName.createSimple(MyQualifier.class.getName())))) {
                context.transform()
                        .removeAll()
                        .add(DotName.createSimple(MyOtherQualifier.class.getName()))
                        .done();
            }
        }
    });
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
理論的には、<a href="#annotations_transformer_build_item"><code>AnnotationsTransformer</code></a> を使用して同じ目標を達成できます。ただし、次の多少の違いがあるため、このタスクには <code>InjectionPointsTransformer</code> の方が適しています。その違いとは次のとおりです。(1) アノテーショントランスフォーマーは Bean 検出中にすべてのクラスに適用されますが、<code>InjectionPointsTransformer</code> は Bean 検出後に検出されたインジェクションポイントにのみ適用されます。(2) <code>InjectionPointsTransformer</code> を使用すると、さまざまなタイプのインジェクションポイント (フィールド、初期化メソッドのパラメーターなど) を処理する必要がありません。
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="use-case-resource-annotations-and-injection"><a class="anchor" href="#use-case-resource-annotations-and-injection"></a>15. ユースケース - リソースアノテーションとインジェクション</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>ResourceAnnotationBuildItem</code> を使用して、Jakarta EE リソースなどの非 CDI インジェクションポイントを解決できるリソースアノテーションを指定できます。インテグレーターは、対応する <code>io.quarkus.arc.ResourceReferenceProvider</code> サービスプロバイダー実装も提供する必要があります。</p>
</div>
<div class="listingblock">
<div class="title"><code>ResourceAnnotationBuildItem</code> の例</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BuildStep
void setupResourceInjection(BuildProducer&lt;ResourceAnnotationBuildItem&gt; resourceAnnotations, BuildProducer&lt;GeneratedResourceBuildItem&gt; resources) {
    resources.produce(new GeneratedResourceBuildItem("META-INF/services/io.quarkus.arc.ResourceReferenceProvider",
        MyResourceReferenceProvider.class.getName().getBytes()));
    resourceAnnotations.produce(new ResourceAnnotationBuildItem(DotName.createSimple(MyAnnotation.class.getName())));
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="build_metadata"><a class="anchor" href="#build_metadata"></a>16. 利用可能なビルドタイムメタデータ</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>BuildExtension.BuildContext</code> で動作する上記のエクステンションはいずれも、ビルドタイムに生成される特定のビルドタイムメタデータを利用することができます。 <code>io.quarkus.arc.processor.BuildExtension.Key</code> にある組込キーは以下の通りです。</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">ANNOTATION_STORE</dt>
<dd>
<p>アノテーショントランスフォーマーを適用した後は、すべての`AnnotationTarget`アノテーションに関する情報を保持する <code>AnnotationStore</code> が含まれます</p>
</dd>
<dt class="hdlist1">INJECTION_POINTS</dt>
<dd>
<p>すべてのインジェクションポイントを含む <code>Collection&lt;InjectionPointInfo&gt;</code></p>
</dd>
<dt class="hdlist1">BEANS</dt>
<dd>
<p>すべての Bean を含む <code>Collection&lt;BeanInfo&gt;</code></p>
</dd>
<dt class="hdlist1">REMOVED_BEANS</dt>
<dd>
<p><code>Collection&lt;BeanInfo&gt;</code> 削除されたすべての <a href="cdi-reference.html#remove_unused_beans">Bean</a> を含む</p>
</dd>
<dt class="hdlist1">OBSERVERS</dt>
<dd>
<p>すべてのオブザーバーを含む <code>Collection&lt;ObserverInfo&gt;</code></p>
</dd>
<dt class="hdlist1">SCOPES</dt>
<dd>
<p>カスタムスコープも含め、すべてのスコープを含む <code>Collection&lt;ScopeInfo&gt;</code></p>
</dd>
<dt class="hdlist1">QUALIFIERS</dt>
<dd>
<p>すべての修飾子を含む <code>Map&lt;DotName, ClassInfo&gt;</code></p>
</dd>
<dt class="hdlist1">INTERCEPTOR_BINDINGS</dt>
<dd>
<p>すべてのインターセプターバインディングを含む <code>Map&lt;DotName, ClassInfo&gt;</code></p>
</dd>
<dt class="hdlist1">STEREOTYPES</dt>
<dd>
<p>すべてのステレオタイプを含む <code>Map&lt;DotName, StereotypeInfo&gt;</code></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>これらのメタデータを取得するには、そのキーのエクステンションコンテキストオブジェクトをクエリするだけ可能です。これらのメタデータはビルドが進むにつれて利用可能になることに注意してください。エクステンションがまだ生成されていないメタデータを取得しようとすると、 <code>null</code> が返されます。どのエクステンションがどのメタデータにアクセスできるかをまとめてみました。</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">AnnotationsTransformer</dt>
<dd>
<p>ブートストラップのどのフェーズでもいつでも使えるので、メタデータに頼るべきではありません。</p>
</dd>
<dt class="hdlist1">ContextRegistrar</dt>
<dd>
<p><code>ANNOTATION_STORE</code> , <code>QUALIFIERS</code> , <code>INTERCEPTOR_BINDINGS</code> . <code>STEREOTYPES</code> にアクセスできます。</p>
</dd>
<dt class="hdlist1">InjectionPointsTransformer</dt>
<dd>
<p><code>ANNOTATION_STORE</code> , <code>QUALIFIERS</code> , <code>INTERCEPTOR_BINDINGS</code> . <code>STEREOTYPES</code> にアクセスできます。</p>
</dd>
<dt class="hdlist1">ObserverTransformer</dt>
<dd>
<p><code>ANNOTATION_STORE</code> , <code>QUALIFIERS</code> , <code>INTERCEPTOR_BINDINGS</code> . <code>STEREOTYPES</code> にアクセスできます。</p>
</dd>
<dt class="hdlist1">BeanRegistrar</dt>
<dd>
<p><code>ANNOTATION_STORE</code>, <code>QUALIFIERS</code>, <code>INTERCEPTOR_BINDINGS</code>, <code>STEREOTYPES</code>, <code>BEANS</code> (クラスベースBeanのみ), <code>OBSERVERS</code> (クラスベースobserverのみ), <code>INJECTION_POINTS</code> にアクセスできます。</p>
</dd>
<dt class="hdlist1">ObserverRegistrar</dt>
<dd>
<p><code>ANNOTATION_STORE</code> , <code>QUALIFIERS</code> , <code>INTERCEPTOR_BINDINGS</code> , <code>STEREOTYPES</code> , <code>BEANS</code> , <code>OBSERVERS</code> (クラスベースのオブザーバーのみ), <code>INJECTION_POINTS</code> にアクセス可能です。</p>
</dd>
<dt class="hdlist1">BeanDeploymentValidator</dt>
<dd>
<p>すべてのビルドメタデータにアクセスできます</p>
</dd>
</dl>
</div>
</div>
</div>
    </div>
    <div class="grid__item width-4-12 width-12-12-m tocwrapper">
      <div class="hide-mobile toc"><ul class="sectlevel1">
<li><a href="#metadata-sources">1. メタデータソース</a></li>
<li><a href="#use-case-my-class-is-not-recognized-as-a-bean">2. ユースケース - クラスがBeanとして認識されません</a>
<ul class="sectlevel2">
<li><a href="#additional_bean_build_item">2.1. <em>理由1</em> :クラスが発見されない</a></li>
<li><a href="#reason-2-class-is-discovered-but-has-no-bean-defining-annotation">2.2. <em>理由2</em> : クラスは発見されたが、Beanを定義するアノテーションがない</a></li>
<li><a href="#unremovable_builditem">2.3. <em>理由3</em>: クラスが検出され、Bean 定義のアノテーションがあるが削除された</a></li>
</ul>
</li>
<li><a href="#use-case-my-annotation-is-not-recognized-as-a-qualifier-or-an-interceptor-binding">3. ユースケース - アノテーションが修飾子またはインターセプターバインディングとして認識されない</a></li>
<li><a href="#annotations_transformer_build_item">4. ユースケース - アノテーションのメタデータを変換する必要がある場合</a>
<ul class="sectlevel2">
<li><a href="#how-to-enable-trace-logging-for-annotation-transformers">4.1. Annotation TransformerのTrace Loggingを有効にする方法</a></li>
</ul>
</li>
<li><a href="#inspect_beans">5. ユースケース - Bean、オブザーバー、インジェクションポイントの検査</a>
<ul class="sectlevel2">
<li><a href="#solution-1-beandiscoveryfinishedbuilditem">5.1. <em>解決策1.</em> <code>BeanDiscoveryFinishedBuildItem</code></a></li>
<li><a href="#solution-2-synthesisfinishedbuilditem">5.2. <em>解決策2</em> : <code>SynthesisFinishedBuildItem</code></a></li>
</ul>
</li>
<li><a href="#synthetic_beans">6. ユースケース - 合成 Bean の必要性</a>
<ul class="sectlevel2">
<li><a href="#synthetic-injection-points">6.1. Synthetic Injection Points</a></li>
<li><a href="#inactive-synthetic-beans">6.2. Inactive Synthetic Beans</a></li>
</ul>
</li>
<li><a href="#synthetic_observers">7. ユースケース - 合成オブザーバー</a></li>
<li><a href="#generated_beans">8. ユースケース - 生成された Bean クラスがある</a></li>
<li><a href="#use-case-i-need-to-validate-the-deployment">9. ユースケース - デプロイメントを検証する必要がある</a></li>
<li><a href="#custom_context">10. ユースケース - カスタム CDI コンテキストの登録</a>
<ul class="sectlevel2">
<li><a href="#what-if-i-need-to-know-all-the-scopes-used-in-the-application">10.1. アプリケーションで使用されているすべてのスコープを知る必要がある場合はどうなりますか?</a></li>
</ul>
</li>
<li><a href="#additional_interceptor_bindings">11. ユースケース - 追加のインターセプターバインディング</a></li>
<li><a href="#use-case-additional-qualifiers">12. 使用例 - 追加の修飾子</a></li>
<li><a href="#use-case-additional-stereotypes">13. 使用例 - 追加のステレオタイプ</a></li>
<li><a href="#injection_point_transformation">14. ユースケース - インジェクションポイントの変換</a></li>
<li><a href="#use-case-resource-annotations-and-injection">15. ユースケース - リソースアノテーションとインジェクション</a></li>
<li><a href="#build_metadata">16. 利用可能なビルドタイムメタデータ</a></li>
</ul></div>
    </div>
  </div>
  <h2>関連コンテンツ</h2>
  <div class="grid-wrapper relations">
    <div class="grid__item width-6-12 width-12-12-m">
      <h3>On the same extensions</h3>
      <ul class="related-content">
      
        
        <li class="guide"><a href="/guides/lifecycle">アプリケーションの初期化と終了</a></li>
      
        
        <li class="reference"><a href="/guides/cdi-reference">コンテキストと依存性インジェクション</a></li>
      
        
        <li class="guide"><a href="/guides/cdi">コンテキストと依存性注入(CDI)の紹介</a></li>
      </ul>
    </div>
    <div class="grid__item width-6-12 width-12-12-m">
      <h3>On the same topics</h3>
      <ul class="related-content">
      
        
        <li class="reference"><a href="/guides/cdi-reference">コンテキストと依存性インジェクション</a></li>
      
        
        <li class="guide"><a href="/guides/cdi">コンテキストと依存性注入(CDI)の紹介</a></li>
      </ul>
    </div>
    </div>
  </div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_reverse.svg" class="project-logo" title="Quarkus"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Quarkusはオープンです。このプロジェクトのすべての依存関係は、<a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>Apache Software License 2.0</a> または互換性のあるライセンスのもとで利用可能です。<br /><br />このウェブサイトは<a href='https://jekyllrb.com/' target='_blank'>Jekyll</a> で構築され、<a href='https://pages.github.com/' target='_blank'>GitHub Pages</a> にホストされ、完全にオープンソースです。改善したい場合は、<a href='https://github.com/quarkusio/quarkusio.github.io' target='_blank'>ウェブサイトをフォーク</a>し、修正してみせてください。</p>

    
      <div class="width-1-12 project-links">
        <span>ナビゲーション</span>
        <ul class="footer-links">
          
          
            <li><a href="/" target="_blank">ホーム</a></li>
          
          
          
            <li><a href="/about" target="_blank">Quarkusについて</a></li>
          
          
          
            <li><a href="/blog" target="_blank">ブログ</a></li>
          
          
          
            <li><a href="/insights" target="_blank">ポッドキャスト</a></li>
          
          
          
            <li><a href="/events" target="_blank">イベント</a></li>
          
          
          
            <li><a href="/newsletter" target="_blank">ニュースレター</a></li>
          
          
          
            <li><a href="https://github.com/orgs/quarkusio/projects/13/views/1" target="_blank">ロードマップ</a></li>
          
          
          
            <li><a href="/security" target="_blank">セキュリティ&nbsp;ポリシー</a></li>
          
          
          
            <li><a href="/usage" target="_blank">使用方法</a></li>
          
          
          
            <li><a href="/brand" target="_blank">Brand</a></li>
          
          
          
            <li><a href="/desktopwallpapers" target="_blank">Wallpapers</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>フォローする</span>
        <ul class="footer-links">
          
          
            <li><a href="https://x.com/quarkusio" target="_blank">X</a></li>
          
          
          
            <li><a href="https://bsky.app/profile/quarkus.io" target="_blank">Bluesky</a></li>
          
          
          
            <li><a rel="me" href="https://fosstodon.org/@quarkusio" target="_blank">Mastodon</a></li>
            
          
          
            <li><a href="https://www.facebook.com/quarkusio" target="_blank">Facebook</a></li>
          
          
          
            <li><a href="https://www.linkedin.com/company/quarkusio/" target="_blank">Linkedin</a></li>
          
          
          
            <li><a href="https://www.youtube.com/channel/UCaW8QG_QoIk_FnjLgr5eOqg" target="_blank">Youtube</a></li>
          
          
          
            <li><a href="https://github.com/quarkusio" target="_blank">GitHub</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-2-12 project-links">
        <span>ヘルプ</span>
        <ul class="footer-links">
          
          
            <li><a href="/support" target="_blank">サポート</a></li>
          
          
          
            <li><a href="/guides" target="_blank">ガイド</a></li>
          
          
          
            <li><a href="/faq" target="_blank">FAQ</a></li>
          
          
          
            <li><a href="/get-started" target="_blank">入門</a></li>
          
          
          
            <li><a href="https://stackoverflow.com/questions/tagged/quarkus" target="_blank">Stack Overflow</a></li>
          
          
          
            <li><a href="https://github.com/quarkusio/quarkus/discussions" target="_blank">ディスカッション</a></li>
          
          
          
            <li><a href="https://groups.google.com/forum/#!forum/quarkus-dev" target="_blank">開発メーリングリスト</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>言語</span>
        <ul class="footer-links">
          
          
            <li><a href=" https://quarkus.io/ " target="_blank">English</a></li>
          
          
          
            <li><a href="https://pt.quarkus.io/" target="_blank">Português&nbsp;(Brasileiro)</a></li>
          
          
          
            <li><a href=" https://es.quarkus.io/ " target="_blank">Español</a></li>
          
          
          
            <li><a href="https://cn.quarkus.io/" target="_blank">简体中文</a></li>
          
          
          
            <li><a href=" https://ja.quarkus.io/ " target="_blank">日本語</a></li>
          
          
        </ul>
      </div>
    

    
      <div class="width-4-12 more-links">
        <span>Quarkusはコミュニティプロジェクトで構成されています</span>
        <ul class="footer-links">
          
            <li><a blah href="https://vertx.io/" target="_blank">Eclipse Vert.x</a></li>
          
            <li><a blah href="https://smallrye.io" target="_blank">SmallRye</a></li>
          
            <li><a blah href="https://hibernate.org" target="_blank">Hibernate ORM</a></li>
          
            <li><a blah href="https://netty.io" target="_blank">Netty</a></li>
          
            <li><a blah href="https://resteasy.github.io" target="_blank">RESTEasy</a></li>
          
            <li><a blah href="https://camel.apache.org" target="_blank">Apache Camel</a></li>
          
            <li><a blah href="https://microprofile.io" target="_blank">Eclipse MicroProfile</a></li>
          
            <li><a blah href="https://code.quarkus.io/" target="_blank">その他多数...</a></li>
          
        </ul>
      </div>
    
  </div>
</div>

  <div class="content redhat-footer">
  <div class="grid-wrapper">
    <span class="licence">
      <i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i> <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC by 3.0</a> | <a href="https://www.redhat.com/en/about/privacy-policy">Privacy Policy</a>
    </span>
    <span class="redhat">
      Sponsored by
    </span>
    <span class="redhat-logo">
      <a href="https://www.redhat.com/" target="_blank"><img src="/assets/images/redhat_reversed.svg"></a>
    </span>
  </div>
</div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/assets/javascript/scroll-down.js"></script>
  <script src="/assets/javascript/satellite.js" type="text/javascript"></script>
  <script src="/guides/javascript/config.js" type="text/javascript"></script>
  <script src="/assets/javascript/guides-version-dropdown.js" type="text/javascript"></script>
  <script src="/assets/javascript/back-to-top.js" type="text/javascript"></script>
  <script src="/assets/javascript/clipboard.min.js" type="text/javascript"></script>
  <script src="/assets/javascript/copy.js" type="text/javascript"></script>
  <script src="/assets/javascript/asciidoc-tabs.js" type="text/javascript"></script>
  <script src="/assets/javascript/future-date.js" type="text/javascript"></script>
</body>

</html>
